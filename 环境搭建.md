## Ironic 环境单独部署文档
#### 请在 Ubuntu 18.04 系统安装
1. 安装 python, pytion-pip（这里的python是版本2.7）
   ```
   sudo apt install python python-pip 
   ```

2. Clone git repo
   ```
   git clone https://github.com/biaocy/ansible-ironic-standalone.git
   ```

3. 安装 ansible-ironic-standalone requirements
   ```
   cd ansible-ironic-standalone
   pip install -r requirements.txt
   ```

4. 配置 ansible-ironic-standalone（以下**脚本根目录**指`ansible-ironic-standalone`文件夹目录）
    1. 在脚本根目录下的`var`目录下创建`test`目录，并在`test`目录下创建`Ironic.yml`文件，内容从`vars/vbox/Ironic.xml`文件拷贝
    2. `mysql`，`rabbitmq`密码: 在`4.1`步骤创建的`Ironic.xml`文件中，按需修改`Ironic_database_root_password`，`Ironic_messaging_pass`，`Ironic_database_pass`参数
    3. `ironic`安装版本: 在`roles/ironic/vars/main.yml`文件中，按需修改`ironic_release`参数，值为OpenStack 版本名小写，例如`queens`，`rocky`（**注意，该脚本从 Ubuntu CloudArchive 源安装 OpenStack 组件，目前OpenStack 在 Ubuntu 的 CloudArchive，16.04 只支持到 Queens 版本，Rocky 版本需要到 Ubuntu 18.04 才支持，该仓库默认安装 Rocky 版本 Ironic**）
    4. `inspector`安装版本: 在`roles/inspector/vars/main.yml`文件中，按需修改`ironic_inspector_release`，值参考`4.3`
    5. `rabbitmq`安装版本：在`roles/rabbitmq/vars/main.yml`文件中，按需修改`rabbitmq_repo_release`，值参考`4.3`
    6. （可选）`Ironic debug`模式: 在`roles/ironic/defaults/main.yml`文件中，按需修改`ironic_debug`参数，默认为`False`（**注意首字母大写**）

5. （可选）配置 ansible 日志
    1. 在脚本根目录下的`ansible.cfg`文件中，定义`log_path`参数，值为日志文件绝对路径

6. 运行 ansible-playbook 安装`ironic`及所需服务
    - 若当前用户无需密码即可`sudo`，则在脚本根目录下运行`ansible-playbook -vvvv -i inventory/inventory.test.ini setup.yml`
    - 若当前用户需要密码才可`sudo`，则在脚本根目录下运行`为ansible-playbook -vvvv -K -i inventory/inventory.test.ini setup.yml`

7. 复制 rootwrap 配置文件
    1. 将脚本根目录下的`etc`文件夹内容复制到系统`/etc`文件夹下